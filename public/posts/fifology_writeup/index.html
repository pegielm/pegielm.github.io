<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>fifology writeup - pegielm</title><link rel="icon" type="image/png" href=https://img.icons8.com/?size&#61;100&amp;id&#61;16133&amp;format&#61;png&amp;color&#61;000000 /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="writeup of the fifology challenge from zeroday ctf (which I created)" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/posts/fifology_writeup/">
  <meta property="og:site_name" content="pegielm">
  <meta property="og:title" content="fifology writeup">
  <meta property="og:description" content="writeup of the fifology challenge from zeroday ctf (which I created)">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-12-03T00:00:00+00:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Rev">
    <meta property="article:tag" content="Zeroday">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="fifology writeup">
  <meta name="twitter:description" content="writeup of the fifology challenge from zeroday ctf (which I created)">
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.d902908ac6e0fab67957de5db5aea1b6455b19ae2ca98eac4c95a4a0fdc02238.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.c95c5dcf5f32f8b67bd36f7dab66680e068fce2b303087294114aabf7a7c080b.css"  disabled />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">pegielm</a>
	</div>
	<nav>
		
		<a href="/">home</a>
		
		<a href="/posts">all posts</a>
		
		<a href="/about">about me</a>
		
		<a href="/tags">tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">fifology writeup</h1>
			<div class="meta">Posted on Dec 3, 2024</div>
		</div>
		

		<section class="body">
			<h1 id="challenge-description">Challenge description</h1>
<p>In the age of old, before the Stack-mages seized dominion over enchanted devices, only a select few possessed the wisdom to unravel the mysteries of the arcane queue language.</p>
<p>files :</p>
<p><a href="/files/fifology/program.txt">program.fo</a></p>
<p><a href="/files/fifology/documentation.txt">documentation.md</a></p>
<h1 id="solution">Solution</h1>
<p>we can seperate the code into parts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ASM" data-lang="ASM"><span style="display:flex;"><span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">6</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">102</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">108</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">97</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">103</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">58</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">32</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">SYSCALL</span><span style="color:#75715e">;
</span></span></span></code></pre></div><p>prints <code>flag: </code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ASM" data-lang="ASM"><span style="display:flex;"><span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">244</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">100</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">224</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">108</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">192</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">92</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">230</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">116</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">202</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">43</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">210</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">105</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">178</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">101</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">162</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">13</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">37</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">78</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">182</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">78</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">166</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">84</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">154</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">72</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">168</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">72</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">168</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">76</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">178</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">68</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">146</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">70</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">166</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">92</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#ae81ff">34</span><span style="color:#75715e">;
</span></span></span></code></pre></div><p>this part of the code is a flag chars before decryption.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ASM" data-lang="ASM"><span style="display:flex;"><span><span style="color:#a6e22e">MOV</span> <span style="color:#66d9ef">A</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">;  // index
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">POP</span> <span style="color:#66d9ef">B</span><span style="color:#75715e">;    // take the flag char into B
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">CMP</span> <span style="color:#66d9ef">B</span> <span style="color:#ae81ff">13</span><span style="color:#75715e">; // if flag char == 13...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JNZ</span> <span style="color:#ae81ff">50</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">MOV</span> <span style="color:#66d9ef">B</span> <span style="color:#ae81ff">33</span><span style="color:#75715e">; // ...replace it with 33
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">CMP</span> <span style="color:#66d9ef">B</span> <span style="color:#ae81ff">37</span><span style="color:#75715e">; // if flag char == 37...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JNZ</span> <span style="color:#ae81ff">53</span><span style="color:#75715e">;   
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">MOV</span> <span style="color:#66d9ef">B</span> <span style="color:#ae81ff">172</span><span style="color:#75715e">; // ...replace it with 172
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">MOV</span> <span style="color:#66d9ef">C</span> <span style="color:#66d9ef">A</span><span style="color:#75715e">;  // C = index
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">CMP</span> <span style="color:#66d9ef">C</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">;  // (loop2 start)if index == 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JZ</span> <span style="color:#ae81ff">60</span><span style="color:#75715e">;   //go to DIV B 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">CMP</span> <span style="color:#66d9ef">C</span> <span style="color:#ae81ff">1</span><span style="color:#75715e">; // if index == 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JZ</span> <span style="color:#ae81ff">61</span><span style="color:#75715e">;  //go to ADD B A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">SUB</span> <span style="color:#66d9ef">C</span> <span style="color:#ae81ff">2</span><span style="color:#75715e">; // index -= 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JMP</span> <span style="color:#ae81ff">54</span><span style="color:#75715e">; //loop2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">DIV</span> <span style="color:#66d9ef">B</span> <span style="color:#ae81ff">2</span><span style="color:#75715e">; //happens if index == 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">ADD</span> <span style="color:#66d9ef">B</span> <span style="color:#66d9ef">A</span><span style="color:#75715e">; // index is added to flag char
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">PUSH</span> <span style="color:#66d9ef">B</span><span style="color:#75715e">; // add the flag char to the stack
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">CMP</span> <span style="color:#66d9ef">A</span> <span style="color:#ae81ff">33</span><span style="color:#75715e">; // if index == 33
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JZ</span> <span style="color:#ae81ff">67</span><span style="color:#75715e">;    //break
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">ADD</span> <span style="color:#66d9ef">A</span> <span style="color:#ae81ff">1</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">JMP</span> <span style="color:#ae81ff">46</span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">SYSCALL</span><span style="color:#75715e">; //print flag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">END</span> 
</span></span></code></pre></div><p>this is loop that iterates over the len of flag (34) and adds index of char to the char itself.
then if index is divisible by 2, it divides the char by 2.</p>
<p>solve script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n <span style="color:#f92672">=</span> [<span style="color:#ae81ff">244</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">224</span>,<span style="color:#ae81ff">108</span>,<span style="color:#ae81ff">192</span>,<span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">230</span>,<span style="color:#ae81ff">116</span>,<span style="color:#ae81ff">202</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">210</span>,<span style="color:#ae81ff">105</span>,<span style="color:#ae81ff">178</span>,<span style="color:#ae81ff">101</span>,<span style="color:#ae81ff">162</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">78</span>,<span style="color:#ae81ff">182</span>,<span style="color:#ae81ff">78</span>,<span style="color:#ae81ff">166</span>,<span style="color:#ae81ff">84</span>,<span style="color:#ae81ff">154</span>,<span style="color:#ae81ff">72</span>,<span style="color:#ae81ff">168</span>,<span style="color:#ae81ff">72</span>,<span style="color:#ae81ff">168</span>,<span style="color:#ae81ff">76</span>,<span style="color:#ae81ff">178</span>,<span style="color:#ae81ff">68</span>,<span style="color:#ae81ff">146</span>,<span style="color:#ae81ff">70</span>,<span style="color:#ae81ff">166</span>,<span style="color:#ae81ff">92</span>]
</span></span><span style="display:flex;"><span>n[n<span style="color:#f92672">.</span>index(<span style="color:#ae81ff">13</span>)] <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>
</span></span><span style="display:flex;"><span>n[n<span style="color:#f92672">.</span>index(<span style="color:#ae81ff">37</span>)] <span style="color:#f92672">=</span> <span style="color:#ae81ff">172</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [ chr((n[i]<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span>i) <span style="color:#66d9ef">if</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#f92672">==</span><span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> chr(n[i]<span style="color:#f92672">+</span>i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(n))]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>zeroday{m4ster_0f_magic_languages}
</span></span></code></pre></div><p>also i wrote interpreter for FIFO-ASM, you can run your challenge with it :)</p>
<p>you can find it here <a href="/files/fifology/interpreter.py">interpreter.py</a> run with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>python3 interpreter.py --file program.fo
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>python3 interpreter.py --debug --file program.fo
</span></span></code></pre></div>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/ctf">ctf</a></li>
					
					<li><a href="/tags/rev">rev</a></li>
					
					<li><a href="/tags/zeroday">zeroday</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/pegielm" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://x.com/pegielm/" rel="me" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024   © pegielm |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
